#!/bin/sh
set -e

LLAMAFILE_PATH=${LLAMAFILE_PATH:-$(find "/opt/llamafile" -name "*.llamafile" -type f)}

echo "Starting llamafile..."

echo 'whoami'
whoami # sbx_user1051

echo 'ulimit -l'
ulimit -l # 64

# Options that might make sense for you:
# 
# --path /nonexistent
# Avoid serving the non-API web interface.

# Option I am still testing out.
# 
# --server \
# --fast \
# --nocompile \
# --threads 3 \
# --threads-batch 5 \
# --timeout 600 \
# --gpu DISABLE
# --mlock \

$LLAMAFILE_PATH \
  --nobrowser \
  --log-disable \
  --host 127.0.0.1 \
  --port 8080
